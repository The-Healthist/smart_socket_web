import"./base-CHC5KoCc.js";import{O as p,D as L,h as _}from"./moment-BQFaItiI.js";import{s as g,a as G}from"./index-C8rzKqQ3.js";import{I as J}from"./InvertedButton-B43qZtpD.js";import{_ as Q}from"./PrimaryButton.vue_vue_type_script_setup_true_lang-scL_XI_H.js";import{_ as W}from"./index-B68_FZo7.js";import{d as M,c,l as X,p as i,v as Y,a as r,b as e,e as a,F as Z,z as tt,w as x,n as $,m as b,A as et,B as st,t as l,o as d,i as h}from"./index-D0pO9Tvl.js";import{u as ot,a as lt,b as nt,c as at}from"./textStore-CRw0B2M-.js";import{a as H,r as it,p as rt,e as dt}from"./order-CGegnj1S.js";import{e as ut,v as ct}from"./data-C6fO1sHB.js";const ft={class:"flex flex-col w-full h-full justify-center items-center px-2.5 py-5"},xt={class:"w-[95vw] h-full flex flex-col"},mt={class:"bg-base w-[95vw] h-[auto] flex flex-col overflow-y-scroll rounded-card mt-[10vh]"},vt={class:"flex flex-col gap-2.5"},pt={class:"flex justify-between items-center"},bt={class:"text-large font-bold"},wt={class:"flex justify-between items-center"},yt={class:"text-large font-bold"},_t={class:"flex justify-between items-center"},gt={class:"text-large font-bold"},ht={class:"flex justify-between items-center"},Ct={class:"text-large font-bold"},jt={class:"flex justify-between items-center"},kt={class:"text-large font-bold"},St={class:"flex justify-between items-center"},Dt={class:"text-base"},Ft={class:"flex justify-between items-center"},Ot={class:"text-base"},$t={class:"flex justify-between items-center"},Ht={class:"text-base"},Mt={class:"flex justify-between items-center"},Bt={class:"text-small font-bold flex items-end justify-end"},Tt={class:"flex justify-between items-end"},zt={class:"text-small font-bold flex items-end justify-end"},Rt={class:"flex justify-between items-center"},It={key:0,class:"flex justify-between items-center"},Pt={class:"grow h-[22px] flex flex-row justify-center items-center gap-2"},At={key:1,class:"flex justify-between items-center w-full"},Vt={class:"w-full"},qt={class:"flex flex-row gap-2.5 w-full"},Kt=["onClick"],Nt={class:"grow h-[22px] flex flex-row justify-center items-center gap-2"},Ut={class:"flex flex-col h-[auto] bg-gradient-to-b from-skin-primary/10 to-skin-primary/30 items-center px-2.5 py-5 gap-2.5"},Et={class:"flex flex-row items-center w-full -ml-2.5"},Lt={class:"-mt-2 w-full h-[38px] p-[5px] bg-base justify-center items-center rounded-button border-solid border-[2px]"},Gt={class:"flex flex-row"},Jt={class:"flex flex-row w-full ml-2 justify-between"},Qt={key:0,class:"text-primary text-large mr-[26px]"},Wt={key:0,class:"h-2.5 w-full -mt-2.5 text-small ml-[2px] text-red-500"},Xt={class:"h-[24px] flex flex-row justify-center items-center gap-2"},Yt=M({name:"OrderDetails"}),ue=M({...Yt,setup(Zt){const B=ot(),T=c(()=>B.getTheme),z=lt(),R=c(()=>z.getRounded),I=nt(),P=c(()=>I.getFontSize),A=at(),C=c(()=>A.getText),j=X(),k=j.currentRoute.value.query.uuid,m=i([]),n=i("");Y(async()=>{typeof k=="string"&&H({uuid:k}).then(o=>{console.log(o);let t=o.data;m.value=[t],u.value=t.quantity,t.status===p.Pending?n.value="待支付":t.status===p.Ongoing?n.value="正在使用中":t.status===p.Ended?n.value="已完成":t.status===p.Closed&&(n.value="已關閉")}).catch(o=>{console.error("Failed to fetch order details:",o)})});const v=i(!1),S=i(""),u=i(2),V=c(()=>ut(u.value,w.value)),D=i(!1),q=c(()=>ct("numberM",u.value)),K=async o=>{dt({uuid:o}).then(t=>{console.log(t);let f=t;m.value=f,console.log(m.value),G("訂單已取消")}).catch(t=>{console.log(t),g(`訂單取消失敗:${t.response.data.message}`)})},w=i(),F=async o=>{H({uuid:o}).then(t=>{t.data.device.priceFormula?(console.log(t.data.device.priceFormula),w.value=t.data.device.priceFormula):console.log("Price formula not found")}).catch(t=>{console.log(t),g(`獲取訂單失敗:${t.response.data.message}`)}),S.value=o,v.value=!0},N=async()=>{if(!q.value){D.value=!0;return}it({uuid:S.value,duration:u.value}).then(o=>{console.log(o),rt({uuid:o.data.uuid}).then(t=>{console.log(t),j.push({name:"PayedAfter",query:{orderId:o.data.uuid}})}).catch(t=>{console.log(t),g(`支付失敗:${t.response.data.message}`)}),v.value=!1})};return(o,t)=>{const f=W,y=Q,U=J,E=L;return d(),r("div",{class:$([` font-${C.value} theme-color-${T.value} theme-rounded-${R.value} theme-fontsize-${P.value} font-${C.value}`,"text-muted bg-gradient-to-b from-skin-primary to-skin-primary/10 h-[140vh]"])},[e("div",ft,[e("div",xt,[e("div",mt,[t[16]||(t[16]=e("div",{class:"text-primary text-largest flex justify-center items-center"}," 訂單詳情 ",-1)),(d(!0),r(Z,null,tt(m.value,s=>(d(),r("div",{key:s.uuid,class:"w-[95vw] p-2.5 flex flex-col gap-2 mt-2"},[e("div",vt,[e("div",pt,[t[2]||(t[2]=e("span",{class:"text-base text-baseC font-bold truncate"},"插座名稱 :",-1)),e("div",bt,l(s.device.name),1)]),e("div",wt,[t[3]||(t[3]=e("span",{class:"text-base text-baseC font-bold truncate"},"插座地址 :",-1)),e("div",yt,l(s.device.location),1)]),e("div",_t,[t[4]||(t[4]=e("span",{class:"text-base text-baseC font-bold truncate"},"購買時間 :",-1)),e("div",gt,l(s.quantity)+"小時",1)]),e("div",ht,[t[5]||(t[5]=e("span",{class:"text-base text-baseC font-bold truncate"},"支付金額 :",-1)),e("div",Ct,l(s.price)+"HKD",1)]),e("div",jt,[t[6]||(t[6]=e("span",{class:"text-base text-baseC font-bold truncate"},"支付方式 :",-1)),e("div",kt,l(s.paymentMethod),1)]),e("div",St,[t[7]||(t[7]=e("span",{class:"text-base text-baseC font-normal truncate"},"訂單創建時間 :",-1)),e("div",Dt,l(h(_)(s.createdAt).format("yyyy/MM/DD HH:ss")),1)]),e("div",Ft,[t[8]||(t[8]=e("span",{class:"text-base text-baseC font-normal truncate"},"服務開始時間 :",-1)),e("div",Ot,l(h(_)(s.startAt).format("yyyy/MM/DD HH:ss")),1)]),e("div",$t,[t[9]||(t[9]=e("span",{class:"text-base text-baseC font-normal truncate"},"服務結束時間 :",-1)),e("div",Ht,l(h(_)(s.endAt).format("yyyy/MM/DD HH:ss")),1)]),e("div",Mt,[t[10]||(t[10]=e("span",{class:"text-base text-baseC font-normal truncate"},"訂單編號 :",-1)),e("div",Bt,l(s.uuid),1)]),e("div",Tt,[t[11]||(t[11]=e("span",{class:"text-base text-baseC font-normal truncate"},"設備編號 :",-1)),e("div",zt,l(s.device.uuid),1)]),e("div",Rt,[t[12]||(t[12]=e("span",{class:"text-base text-baseC font-normal truncate"},"訂單狀態 :",-1)),e("div",{class:$(["text-large font-bold",n.value=="已完成"?"text-baseC/40":n.value=="待支付"?"text-primary/60":"text-text-[#00a5ff]"])},l(n.value),3)]),n.value=="待支付"?(d(),r("div",It,[a(y,{class:"grow w-full",onClick:O=>F(s.uuid)},{default:x(()=>[e("div",Pt,[a(f,{icon:"mingcute:flash-line",class:"text-[20px]"}),t[13]||(t[13]=e("span",{class:"text-larger text-inverted font-bold tracking-wide"},"支付訂單",-1))])]),_:2},1032,["onClick"])])):b("",!0),n.value==="正在使用中"?(d(),r("div",At,[e("div",Vt,[e("div",qt,[a(U,null,{default:x(()=>[e("div",{class:"w-[22vw] h-[22px] flex flex-row justify-center items-center",onClick:O=>K(s.uuid)},t[14]||(t[14]=[e("span",{class:"text-base text-primary font-bold font-CactusClassicalSerifHK text-center"}," 結束使用 ",-1)]),8,Kt)]),_:2},1024),a(y,{class:"grow w-full",onClick:O=>F(s.uuid)},{default:x(()=>[e("div",Nt,[a(f,{icon:"mingcute:flash-line",class:"text-[20px]"}),t[15]||(t[15]=e("span",{class:"text-larger text-inverted font-bold tracking-wide"},"充值續費",-1))])]),_:2},1032,["onClick"])])])])):b("",!0)])]))),128)),t[17]||(t[17]=e("div",null,[e("div",{class:"flex flex-row justify-center items-center gap-2.5 w-full mb-5 mt-2.5"},[e("button",{class:"text-primary text-base font-normal"}," 有疑問？聯繫客服 ")])],-1))])])]),a(E,{show:v.value,"onUpdate:show":t[1]||(t[1]=s=>v.value=s),"show-cancel-button":!1,showConfirmButton:!1,"close-on-click-overlay":!0},{default:x(()=>[e("div",Ut,[t[22]||(t[22]=e("h1",{class:"text-largest test-basec"},"充值續費",-1)),t[23]||(t[23]=e("span",{class:"flex flex-row justify-start text-baseC text-base w-full ml-2.5"},"充值時間",-1)),e("div",Et,[t[19]||(t[19]=e("span",{class:"text-primary text-base"},"*",-1)),e("div",Lt,[e("div",Gt,[et(e("input",{id:"number","onUpdate:modelValue":t[0]||(t[0]=s=>u.value=s),type:"number",placeholder:"請輸入充值時間",class:"w-[60vw] h-[24px] pl-2 rounded-button"},null,512),[[st,u.value]]),t[18]||(t[18]=e("span",{class:"text-primary text-large mr-1.5"},"/小時",-1))])])]),e("div",Jt,[t[20]||(t[20]=e("span",{class:"flex flex-row justify-start text-baseC text-base w-full"}," 總計金額",-1)),w.value?(d(),r("span",Qt,l(V.value)+"HKD",1)):b("",!0)]),D.value?(d(),r("span",Wt," 充值時間需要>0且為整數 ")):b("",!0),a(y,{class:"w-[98%]",onClick:N},{default:x(()=>[e("div",Xt,[a(f,{icon:"mingcute:flash-line",class:"text-[20px]"}),t[21]||(t[21]=e("span",{class:"text-larger text-inverted font-bold tracking-wide"},"即刻支付",-1))])]),_:1})])]),_:1},8,["show"])],2)}}});export{ue as default};
